FROM samloh84/centos:7

ARG VENDOR=microsoft
ARG PRODUCT=dotnet-centos
ARG PRODUCT_VERSION=1.1.2
ARG TEMP_DIR_ROOT=/tmp/${VENDOR}-${PRODUCT}
ARG TEMP_DIR=/${TEMP_DIR_ROOT}/${PRODUCT_VERSION}
ARG INSTALL_DIR_ROOT=/opt/${VENDOR}-${PRODUCT}
ARG INSTALL_DIR=${INSTALL_DIR_ROOT}/${PRODUCT_VERSION}

ARG DOTNET_CORE_INSTALL_TARGZ_URL="https://download.microsoft.com/download/E/7/8/E782433E-7737-4E6C-BFBF-290A0A81C3D7/dotnet-dev-centos-x64.1.0.4.tar.gz"
ARG DOTNET_CORE_INSTALL_TARGZ=dotnet-dev-centos-x64.1.0.4.tar.gz
ARG DOTNET_CORE_SHA256SUM=8e952982414e192cff5980a6190cfdcfef543b59c0be65e5c9d86dc7d4a8ea4b

USER ${ROOT_UID}

RUN \
mkdir -p ${TEMP_DIR} ${INSTALL_DIR} && \
pushd ${TEMP_DIR} && \
curl -LjSs \
${DOTNET_CORE_INSTALL_TARGZ_URL} -o ${DOTNET_CORE_INSTALL_TARGZ} && \
tar -xf ${DOTNET_CORE_INSTALL_TARGZ} -C ${INSTALL_DIR} && \
fix-ownership ${INSTALL_DIR} && \
fix-permissions ${INSTALL_DIR} && \
popd && \
rm -rf ${TEMP_DIR_ROOT}

ENV DOTNET_CORE_HOME ${INSTALL_DIR}
ENV PATH ${DOTNET_CORE_HOME}:${PATH}

USER ${APP_UID}



